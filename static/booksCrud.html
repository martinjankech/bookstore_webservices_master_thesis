<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://code.jquery.com/jquery-3.6.1.js" integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI="
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.3/dist/umd/popper.min.js"
    integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"
    integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"
    integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/footer.css">
  <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script> -->
  <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"
    integrity="sha256-lSjKY0/srUM9BE3dPm+c4fBo1dky2v27Gdjm2uoZaL0=" crossorigin="anonymous"></script>
  <!-- jqury kniznica na obmedzenie maximalneho poctu poloziek v autocomplete  -->
  <script src="js/jquery.ui.autocomplete.scroll.min.js"></script>
  <link href="//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.2/jquery-ui.css" rel="stylesheet" />
  <script src="js/app.js"></script>
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.12.1/css/jquery.dataTables.css">
  <script type="text/javascript" charset="utf8"
    src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.js"></script>
  <link rel="stylesheet" href="css/datatable.css">
  <link rel="stylesheet" href="css/allbooks.css">
  <title>knihy CRUD</title>

</head>

<body>
  <div id="navbar">
  </div>
  <div id="book-page-alert">
    <div style="display: none;" id="alert_container">
      <div class="alert" role="alert">
        <span id="alert-text"></span>
      </div>
    </div>
  </div>

  <div class="flex-wrapper">
    <div class="container col-11 mt-5 ">
      <button type="button" class="btn btn-primary mb-2" data-toggle="modal" data-target="#addModal">Pridaj
        Knihu</button>
      <div class=" mb-5 table-responsive">
        <table id="bookTable" class=" display nowrap ">
          <thead>
            <tr>
              <th>Náhľad</th>
              <th>ID</th>
              <th>Autor1</th>
              <th>Autor2</th>
              <th>Nazov</th>
              <th>Kategoria</th>
              <th>Jazyk</th>
              <th>ISBN</th>
              <th>Počet strán</th>
              <th>Vazba</th>
              <th>Rok vydania</th>
              <th>Vydavatelstvo</th>
              <th>Predajna_cena</th>
              <th>Nakupna_cena</th>
              <th>Marža</th>
              <th>Zisk kus</th>
              <th>Priemerne hodnotenie</th>
              <th>Obsah</th>
              <th>Aktualizuj</th>
              <th>Zmaž</th>


            </tr>
          </thead>
          <tfoot class="mb-5">
            <tr>
              <th>Náhľad</th>
              <th>ID</th>
              <th>Autor1</th>
              <th>Autor2</th>
              <th>Nazov</th>
              <th>Kategoria</th>
              <th>Jazyk</th>
              <th>ISBN</th>
              <th>Počet strán</th>
              <th>Vazba</th>
              <th>Rok vydania</th>
              <th>Vydavatelstvo</th>
              <th>Predajna_cena</th>
              <th>Nakupna_cena</th>
              <th>Marža</th>
              <th>Zisk kus</th>
              <th>Priemerne hodnotenie</th>
              <th>Obsah</th>
              <th>Aktualizuj</th>
              <th>Zmaž</th>

            </tr>
          </tfoot>
        </table>
      </div>
    </div>
    <footer>
    </footer>
  </div>
  <!-- Button trigger modal -->

  <!-- Modal -->
  <div class="modal fade" id="bookmodal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">údaje o knihe </h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Zavrieť</button>

        </div>
      </div>
    </div>
  </div>

  <!-- Add Modal -->
  <div class="modal fade" id="addModal" tabindex="-1" role="dialog" aria-labelledby="addModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addModalLabel">Pridaj knihu</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Zavrieť">
            <span aria-hidden="true">&times;</span>
          </button>

        </div>
        <div class="modal-body">

          <div style="display: none;" id="alert_container">
            <div class="alert" role="alert">
              <span id="alert-text"></span>
            </div>
          </div>


          <form id="addBook">
            <div class="row">
            </div>
            <div class="row">
              <div class="form-group col-3">
                <label for="nazov">Nazov:</label>
                <input type="text" id="nazov" name="nazov" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="autor1">Autor 1:</label>
                <input type="text" id="autor1" name="autor1" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="autor2">Autor 2:</label>
                <input type="text" id="autor2" name="autor2" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="kategoria">Kategoria:</label>
                <input type="text" id="kategoria" name="kategoria" class="form-control">
              </div>
            </div>
            <div class="row">
              <div class="form-group col-3">
                <label for="isbn">ISBN:</label>
                <input type="text" id="isbn" name="isbn" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="jazyk">Jazyk:</label>
                <input type="text" id="jazyk" name="jazyk" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="pocet_stran">Pocet stran:</label>
                <input type="text" id="pocet_stran" name="pocet_stran" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="vazba">Vazba:</label>
                <input type="text" id="vazba" name="vazba" class="form-control">
              </div>
            </div>
            <div class="row">
              <div class="form-group col-3">
                <label for="rok_vydania">Rok vydania:</label>
                <input type="text" id="rok_vydania" name="rok_vydania" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="vydavatelstvo">Vydavatelstvo:</label>
                <input type="text" id="vydavatelstvo" name="vydavatelstvo" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="predajna_cena">Predajna cena:</label>
                <input type="text" id="predajna_cena" name="predajna_cena" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for=" nakupna_cena">Nakupna cena</label>
                <input id="nakupna_cena" name="nakupna_cena class=" class="form-control">
              </div>
            </div>

            <div class="row">
              <div class="form-group col-3">
                <label for=" priemerne_hodnotenie">Priemerne hodnotenie:</label>
                <input id="priemerne_hodnotenie" name="priemerne_hodnotenie" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for=" obrazok">Obrazok:</label>
                <input type="file" id="obrazok" name="obrazok" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="obsah">Obsah</label>
                <textarea class="form-control" id="obsah" name="obsah" rows="5"></textarea>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Zavrieť</button>
              <button type="submit" class="btn btn-primary">Pridaj knihu</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>


  <!-- Update Modal -->
  <div class="modal fade" id="updateModal" tabindex="-1" role="dialog" aria-labelledby="updateModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="updateModalLabel">Aktualizácia údajov o knihe</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div style="display: none;" id="alert_container">
            <div class="alert" role="alert">
              <span id="alert-text"></span>
            </div>
          </div>
          <form id="updateBookForm">
            <div class="row">
              <div style="display: none;" class="form-group col-3">
                <label for="nazov">id:</label>
                <input type="text" id="update-id" name="id" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="nazov">Nazov:</label>
                <input type="text" id="update-nazov" name="nazov" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="autor1">Autor 1:</label>
                <input type="text" id="update-autor1" name="autor1" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="autor2">Autor 2:</label>
                <input type="text" id="update-autor2" name="autor2" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="kategoria">Kategoria:</label>
                <input type="text" id="update-kategoria" name="kategoria" class="form-control">
              </div>
            </div>
            <div class="row">
              <div class="form-group col-3">
                <label for="isbn">ISBN:</label>
                <input type="text" id="update-isbn" name="isbn" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="jazyk">Jazyk:</label>
                <input type="text" id="update-jazyk" name="jazyk" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="pocet_stran">Pocet stran:</label>
                <input type="text" id="update-pocet_stran" name="pocet_stran" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="vazba">Vazba:</label>
                <input type="text" id="update-vazba" name="vazba" class="form-control">
              </div>
            </div>
            <div class="row">
              <div class="form-group col-3">
                <label for="rok_vydania">Rok vydania:</label>
                <input type="text" id="update-rok_vydania" name="rok_vydania" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="vydavatelstvo">Vydavatelstvo:</label>
                <input type="text" id="update-vydavatelstvo" name="vydavatelstvo" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="predajna_cena">Predajna cena:</label>
                <input type="text" id="update-predajna_cena" name="predajna_cena" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for=" nakupna_cena">Nakupna cena</label>
                <input id="update-nakupna_cena" name="nakupna_cena class=" class="form-control">
              </div>
            </div>

            <div class="row">
              <div class="form-group col-3">
                <label for=" priemerne_hodnotenie">Priemerne hodnotenie:</label>
                <input id="update-priemerne_hodnotenie" name="priemerne_hodnotenie" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for=" obrazok">Obrazok:</label>
                <input type="file" id="update-obrazok" name="obrazok" class="form-control">
              </div>
              <div class="form-group col-3">
                <label for="obsah">Obsah</label>
                <textarea class="form-control" id="update-obsah" name="obsah" rows="5"></textarea>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Zavrieť</button>
              <button type="submit" class="btn btn-primary">Ulož zmeny</button>
            </div>
          </form>
        </div>
      </div>

    </div>

  </div>



  <script>


    $(document).ready(function () {
      $('#bookTable').DataTable({
        language: {
          "processing": "Spracúvanie...",
          "search": "Hľadať:",
          "lengthMenu": "Zobraziť _MENU_ záznamov",
          "info": "Zobrazujem _START_ až _END_ z _TOTAL_ záznamov",
          "infoEmpty": "Zobrazujem 0 až 0 z 0 záznamov",
          "infoFiltered": "(filtrované z _MAX_ celkových záznamov)",
          "infoPostFix": "",
          "loadingRecords": "Načítavanie...",
          "zeroRecords": "Neboli nájdené žiadne vyhovujúce záznamy",
          "emptyTable": "V tabuľke nie sú žiadne dáta",
          "paginate": {
            "first": "Prvá",
            "previous": "Predchádzajúca",
            "next": "Ďalšia",
            "last": "Posledná"
          },
          "aria": {
            "sortAscending": ": aktivujte na zoradenie stĺpca vzostupne",
            "sortDescending": ": aktivujte na zoradenie stĺpca zostupne"
          }
        },
        columnDefs: [
          {
            targets: 3,
            visible: false

          },
          {
            targets: 6,
            visible: false

          },
          {
            targets: 7,
            visible: false

          },
          {
            targets: 8,
            visible: false

          },
          {
            targets: 9,
            visible: false

          },
          {
            targets: 13,
            visible: false

          },
          {
            targets: 14,
            visible: false

          },
          {
            targets: 15,
            visible: false

          },
          {
            targets: 16,
            visible: false

          },
          {
            targets: 17,
            visible: false

          },
        ],

        // defaultne sortovanie podla id 
        order: [[1, 'asc']],
        autoWidth: false,
        ajax: {
          type: 'GET',
          url: "http://localhost:" + appPort + "/book_services.asmx/GetListAllBooks",
          dataSrc: 'books.book',

        },
        success: function (res) {
        },

        dataType: "json",
        columns: [


          {
            data: "obrazok",
            render: (data, type, row) => {

              // return `<a href="singleBookSearcher.html/${row.isbn}` + '"><img style="width:55px ; height:85px ;" src="' + data + '" /> </a>';
              return '<a href=""data-toggle="modal" data-target="#bookmodal" data-obsah="' + row.obsah + '"  data-vazba="' + row.vazba + '"  data-autor1="' + row.autori.autor1 + '"  data-autor2="' + row.autori.autor2 + '" data-obrazok="' + row.obrazok + '" data-id="' + row.id + '" data-nazov="' + row.nazov + '" data-kategoria="' + row.kategoria + '" data-isbn="' + row.isbn + '" data-jazyk="' + row.jazyk + '" data-pocet_stran="' + row.pocet_stran + '" data-vazba="' + row.vazba + '" data-rok_vydania="' + row.rok_vydania + '" data-vydavatelstvo="' + row.vydavatelstvo + '" data-predajna_cena="' + row.predajna_cena + '" data-nakupna_cena="' + row.nakupna_cena + '" data-marza="' + row.marza + '" data-zisk_kus="' + row.zisk_kus + '" data-priemerne_hodnotenie="' + row.priemerne_hodnotenie + '"><img style="width:83px ; height:128px ;" src="' + row.obrazok + '" /> </a>';

            }
          },

          { data: 'id', },

          {
            data: 'autori.autor1',

          },
          {

            data: 'autori.autor2',
          },

          { data: 'nazov', },
          { data: 'kategoria' },
          { data: 'jazyk' },
          { data: 'isbn' },
          { data: 'pocet_stran' },
          { data: 'vazba' },
          { data: 'rok_vydania' },
          { data: 'vydavatelstvo' },
          { data: 'predajna_cena' },
          { data: 'nakupna_cena' },
          { data: 'marza' },
          { data: 'zisk_kus' },
          { data: 'priemerne_hodnotenie' },
          { data: 'obsah' },
          {
            data: null,
            render: function (data, type, row) {
              return `<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#updateModal" data-id="${row.id}" data-autor1="${row.autori.autor1}" data-autor2="${row.autori.autor2}" data-jazyk="${row.jazyk}"  data-pocet_stran="${row.pocet_stran}" data-nazov="${row.nazov}"  data-kategoria="${row.kategoria}"  data-isbn="${row.isbn}" data-vazba="${row.vazba}" data-rok_vydania="${row.rok_vydania}" data-vydavatelstvo="${row.vydavatelstvo}" data-predajna_cena="${row.predajna_cena}" data-nakupna_cena="${row.nakupna_cena}" data-marza="${row.marza}" data-zisk_kus="${row.zisk_kus}" data-priemerne_hodnotenie="${row.priemerne_hodnotenie}" data-obsah="${row.obsah}">Aktualizuj</button>`
            },
          },
          {
            data: null,
            render: function (data, type, row) {
              return `<button type="button" class=" deleteBook btn btn-danger"  data-id="${row.id}">Vymaž</button>`;
            }
          }


          // { data: "", "defaultContent": "<button onclick='edititem();'>Edit</button>" },
          // {
          //   data: '',
          //   render: (data, type, row) => {
          //  return `< a href = 'link_to_edit/${row.id}' > update</a >`;
          //   }
          // }

        ],

      });
    });
    $("#bookmodal").on('show.bs.modal', function (e) {
      var triggerLink = $(e.relatedTarget);
      var id = triggerLink.data("id");
      var nazov = triggerLink.data("nazov");
      var kategoria = triggerLink.data("kategoria");
      var isbn = triggerLink.data("isbn");
      var jazyk = triggerLink.data("jazyk");
      var vazba = triggerLink.data("vazba");
      var pocet_stran = triggerLink.data("pocet_stran");
      var vazba = triggerLink.data("vazba");
      var rok_vydania = triggerLink.data("rok_vydania");
      var vydavatelstvo = triggerLink.data("vydavatelstvo");
      var predajna_cena = triggerLink.data("predajna_cena");
      var nakupna_cena = triggerLink.data("nakupna_cena");
      var marza = triggerLink.data("marza");
      var zisk_kus = triggerLink.data("zisk_kus");
      var priemerne_hodnotenie = triggerLink.data("priemerne_hodnotenie");
      var obsah = triggerLink.data("obsah");
      var obrazok = triggerLink.data("obrazok");
      var autor1 = triggerLink.data("autor1");
      var autor2 = triggerLink.data("autor2");


      // $("#modalTitle").text(title);
      //$(this).find(".modal-body").html("<h5>id: " + id + "</h5> " + "<h5>id: " + nazov + "</h5>");
      $(this).find(".modal-body").html("<div class=\"container \">" +
        "<div class=\"card mt-4 \">" +
        "<div class=\"card-body\">" +
        "<h3 id=\"nazov_hore\" class=\"card-title\">Book Name</h3>" +
        "<h6 id=\"autori_hore\" class=\"card-subtitle\">Book Authors</h6>" +
        " <div class=\"row \">" +
        "<div class=\"col-lg-6 col-md-8 col-sm-12 col-12 \">" +
        " <div  class=\" img-responsive\"><img  id=\"obrazok\"" +
        "src=\"https://via.placeholder.com/350x700/00CED1/000000\">" +
        " </div>" +
        "</div>" +
        " <div class=\"col-lg-6 col-md-4 col-sm-12 col-12\">" +
        "  <h4 class=\"box-title \">Obsah knihy</h4>" +
        "<p id=\"obsah\">Lorem ipsum dolor sit amet consectetur adipisicing elit. Quasi, necessitatibus quis" +
        "repellendus natus eos non beatae a iusto ad, tempora excepturi alias mollitia repellat quidem" +
        "similique ratione ipsam? Rem ducimus porro officia. Culpa quibusdam sed vero voluptas veniam at" +
        "iusto, vitae atque modi est perspiciatis temporibus quas asperiores quia? Velit?</p>" +
        "<h2 id=\"cena_hl\" class=\"mt - 2\">" +
        " </h2>" +
        " <h3 class=\"box-title mt-5\">údaje o knihe</h3>" +
        " <ul class=\"list-unstyled\">" +
        "<li><i class=\"fa fa-check text-success\"></i>nazov: <span id=\"nazov\"></span></li>" +
        "<li><i class=\"fa fa-check text-success\"></i>autori: <span id=\"autori\"></span></li>" +
        "<li><i class=\"fa fa-check text-success\"></i>kategoria: <span id=\"kategoria\"></span></li>" +
        "<li><i class=\"fa fa-check text-success\"></i>isbn: <span id=\"isbn\"></span></li>" +
        "<li><i class=\"fa fa-check text-success\"></i>jazyk: <span id=\"jazyk\"></span></li>" +
        " <li><i class=\"fa fa-check text-success\"></i>vazba: <span id=\"vazba\"></span></li>" +
        "  <li><i class=\"fa fa-check text-success\"></i>pocet stran: <span id=\"pocet_stran\"></span></li>" +
        "<li><i class=\"fa fa-check text-success\"></i>rok vydania: <span id=\"rok_vydania\"></span></li>" +
        " <li><i class=\"fa fa-check text-success\"></i>vydavateľstvo: <span id=\"vydavatelstvo\"></span>" +
        "  </li>" +
        "<li><i class=\"fa fa-check text-success\"></i>predajna cena: <span id=\"predajna_cena\"></span>" +
        " </li>" +
        "<li><i class=\"fa fa-check text-success\"></i>nakupna cena: <span id=\"nakupna_cena\"></span></li>" +
        " <li><i class=\"fa fa-check text-success\"></i>marza: <span id=\"marza\"></span></li>" +
        "<li><i class=\"fa fa-check text-success\"></i>zisk kus: <span id=\"zisk_kus\"></span></li>" +
        " </ul>" +
        " </div>" +
        "</div>" +
        "</div>" +
        "</div >" +

        "</div >");
      if (autor2 != "-") {
        $("#autori").html(autor1 + "," + autor2)
        $("#autori_hore").html(autor1 + "," + autor2)
      }
      else {
        $("#autori").html(autor1)
        $("#autori_hore").html(autor1)
      }
      $("#obrazok").attr('src', obrazok)
      $("#obsah").html(obsah)
      $("#cena_hl").html("€" + predajna_cena)
      $("#nazov_hore").html(nazov)
      $("#nazov").html(nazov)
      $("#kategoria").html(kategoria)
      $("#isbn").html(isbn)
      $("#jazyk").html(jazyk)
      $("#vazba").html(vazba)
      $("#pocet_stran").html(pocet_stran)
      $("#rok_vydania").html(rok_vydania)
      $("#vydavatelstvo").html(vydavatelstvo)
      $("#predajna_cena").html(predajna_cena)
      $("#nakupna_cena").html(nakupna_cena)
      $("#marza").html(Math.round(marza * 100) + "%")
      $("#zisk_kus").html(zisk_kus)
    });


    $('#myModal').on('shown.bs.modal', function () {
      $('#myInput').trigger('focus')
    })
    $("#navbar").load("navbar.html")
    $("footer").load("footer.html")

  </script>
  <script>
    //alert(appPort)
    // add book
    $(document).on('submit', "#addBook", function (event) {
      event.preventDefault();
      var formData = new FormData();
      formData.append("nazov", $("#nazov").val());
      formData.append("autor1", $("#autor1").val());
      formData.append("autor2", $("#autor2").val());
      formData.append("kategoria", $("#kategoria").val());
      formData.append("isbn", $("#isbn").val());
      formData.append("jazyk", $("#jazyk").val());
      formData.append("pocet_stran", $("#pocet_stran").val());
      formData.append("vazba", $("#vazba").val());
      formData.append("rok_vydania", $("#rok_vydania").val());
      formData.append("vydavatelstvo", $("#vydavatelstvo").val());
      formData.append("predajna_cena", $("#predajna_cena").val());
      formData.append("nakupna_cena", $("#nakupna_cena").val());
      formData.append("obsah", $("#obsah").val());
      formData.append("priemerne_hodnotenie", $("#priemerne_hodnotenie").val());
      formData.append("file", $("#obrazok")[0].files[0]);
      var ajaxUrl = "http://localhost:" + appPort + "/book_services.asmx/AddBook";

      $.ajax({
        type: "POST",
        url: ajaxUrl,
        data: formData,
        contentType: false,
        processData: false,
      }).done(function (response) {
        showAlert("Kniha úspešne pridaná", "addModal", "success");
        setTimeout(function () {
          $('#addModal').modal('hide');
          $('#bookTable').DataTable().ajax.reload(null, false);
        }, 3000);
        $("#addBook")[0].reset();
      })
        .fail(function (xhr, status, error) {
          showAlert("Nastala chyba:" + xhr.responseText, "addModal", "danger");
        });
    })
    // update book ajax 
    $(document).on('submit', "#updateBookForm", function (event) {
      event.preventDefault();
      var formData = new FormData();
      formData.append("id", $("#update-id").val());
      formData.append("nazov", $("#update-nazov").val());
      formData.append("autor1", $("#update-autor1").val());
      formData.append("autor2", $("#update-autor2").val());
      formData.append("kategoria", $("#update-kategoria").val());
      formData.append("isbn", $("#update-isbn").val());
      formData.append("jazyk", $("#update-jazyk").val());
      formData.append("pocet_stran", $("#update-pocet_stran").val());
      formData.append("vazba", $("#update-vazba").val());
      formData.append("rok_vydania", $("#update-rok_vydania").val());
      formData.append("vydavatelstvo", $("#update-vydavatelstvo").val());
      formData.append("predajna_cena", $("#update-predajna_cena").val());
      formData.append("nakupna_cena", $("#update-nakupna_cena").val());
      formData.append("obsah", $("#update-obsah").val());
      formData.append("priemerne_hodnotenie", $("#update-priemerne_hodnotenie").val());
      if ($("#update-obrazok")[0].files.length) {
        var file = $("#update-obrazok")[0].files[0];
        var fileName = file.name.split(".")[0];
        var fileExtension = file.name.split(".")[1];
        var timestamp = new Date().getTime();
        var newFileName = fileName + "_" + timestamp + "." + fileExtension;
        formData.append("file", file, newFileName);
      }
      var ajaxUrl = "http://localhost:" + appPort + "/book_services.asmx/UpdateBook";

      $.ajax({
        type: "POST",
        url: ajaxUrl,
        data: formData,
        contentType: false,
        processData: false,
      })
        .done(function (response) {
          showAlert("Kniha uspesne aktualizovana", "updateModal", "success");
          setTimeout(function () {
            $('#updateModal').modal('hide');
            setTimeout(function () {
              $('#bookTable').DataTable().ajax.reload(null, false);
            }, 1500);
          }, 2000);
          $("#updateBookForm")[0].reset();
        })
        .fail(function (xhr, status, error) {
          showAlert("Nastala chyba pri aktualizacii knihy:" + xhr.responseText, "updateModal", "danger");
        });
    });
    $(document).on('click', ".deleteBook", function (event) {
      var id = $(this).data('id');

      if (confirm("Ste si istý že chcete vymazať údaje o knihe? Operácia je nezvratná!!")) {
        $.ajax({
          type: "POST",
          url: "http://localhost:" + appPort + "/book_services.asmx/DeleteBook",
          data: { id: id },
        })
          .done(function (response) {
            showAlert("Kniha uspesne vymazana", "book-page-alert", "success");
            setTimeout(function () {
              $('#bookTable').DataTable().ajax.reload(null, false);
            }, 1500);
          })
          .fail(function (xhr, status, error) {
            showAlert("Nastala chyba: " + xhr.responseText, "book-page-alert", "danger");
          });
      }
    });
  </script>

  </script>

  </script>
  <script>
    //naplenie update formularu datami z aktualneho row data su ziskane z buttonu
    $('#updateModal').on('show.bs.modal', function (event) {

      var button = $(event.relatedTarget);

      var id = button.data('id');
      var autor1 = button.data('autor1');
      var autor2 = button.data('autor2');
      var nazov = button.data('nazov');
      var kategoria = button.data('kategoria');
      var isbn = button.data('isbn');
      var jazyk = button.data('jazyk');
      var pocet_stran = button.data('pocet_stran');
      var vazba = button.data('vazba');
      var rok_vydania = button.data('rok_vydania');
      var vydavatelstvo = button.data('vydavatelstvo');
      var predajna_cena = button.data('predajna_cena').toString().replace(".", ",");;
      var nakupna_cena = button.data('nakupna_cena').toString().replace(".", ",");;
      var marza = button.data('marza');
      var zisk_kus = button.data('zisk_kus');
      var priemerne_hodnotenie = button.data('priemerne_hodnotenie');
      var obsah = button.data('obsah');

      var modal = $(this);
      modal.find('.modal-body #update-id').val(id);
      modal.find('.modal-body #update-kategoria').val(kategoria);
      modal.find('.modal-body #update-isbn').val(isbn);
      modal.find('.modal-body #update-nazov').val(nazov);
      modal.find('.modal-body #update-autor1').val(autor1);
      modal.find('.modal-body #update-autor2').val(autor2);
      modal.find('.modal-body #update-jazyk').val(jazyk);
      modal.find('.modal-body #update-pocet_stran').val(pocet_stran);
      modal.find('.modal-body #update-vazba').val(vazba);
      modal.find('.modal-body #update-rok_vydania').val(rok_vydania);
      modal.find('.modal-body #update-vydavatelstvo').val(vydavatelstvo);
      modal.find('.modal-body #update-predajna_cena').val(predajna_cena);
      modal.find('.modal-body #update-nakupna_cena').val(nakupna_cena);
      modal.find('.modal-body #update-marza').val(marza);
      modal.find('.modal-body #update-zisk_kus').val(zisk_kus);
      modal.find('.modal-body #update-priemerne_hodnotenie').val(priemerne_hodnotenie);
      modal.find('.modal-body #update-obsah').val(obsah);
    });
  </script>



</body>

</html>